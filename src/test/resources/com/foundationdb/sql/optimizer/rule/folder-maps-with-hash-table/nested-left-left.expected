SelectQuery@175bd994
  ResultSet@f298f87[id, s, id, s, id, s]
    MapJoin@776658cc()
      Flatten@612cfeba(t1)
        GroupScan@604ff651(Group(test.t1), rows = 1, cost = 0.00000)
          TableSource@69ff1b3e(t1 - TableGroup@21b4713d(t1))
      Project@718defd7[t1.id, t1.s, t2.id, t2.s, t3.id, t3.s]
        Select@1d7d467f[]
          NullIfEmpty@4d766d14
            UsingHashTable@19f363c7(HashTable@3a1bab20)
              Flatten@5107972d(t3)
                GroupScan@6e7fdfad(Group(test.t3), rows = 1, cost = 0.00000)
                  TableSource@5adced0a(t3 - TableGroup@d360f88(t3))
              MapJoin@5835b07e()
                Flatten@495634ea(t2)
                  GroupScan@2cd64d70(Group(test.t2), rows = 1, cost = 0.00000)
                    TableSource@5e4e5a20(t2 - TableGroup@29760b0f(t2))
                Select@4d01b0d[t2.id == t1.id]
                  Project@7a9ff4f2[t2.id, t2.s, t3.id, t3.s]
                    NullIfEmpty@1b8a7ac3
                      HashTableLookup@2081a655(HashTable@3a1bab20, [t2.id])
                        Flatten@3aac1443(t3)
                          AncestorLookup@1fcf271f(t3 -> [t3])
                            ExpressionsHKeyScan@59117489(TableSource@5adced0a(t3 - TableGroup@d360f88(t3)), t2.id, rows = 1, cost = 6.95200)
                            TableSource@5adced0a(t3 - TableGroup@d360f88(t3))