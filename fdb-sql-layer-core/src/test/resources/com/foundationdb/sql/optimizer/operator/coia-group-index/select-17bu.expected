PhysicalSelect[name:varchar(32), quan:int]
  Project_Default(customers.name, items.quan)
    Sort_General(items.quan DESC)
      Map_NestedLoops(0)
        Flatten_HKeyOrdered(customers INNER addresses)
          GroupLookup_Default(Index(addresses.state) -> customers, addresses)
            UnionAll_Default()
              UnionAll_Default()
                IndexScan_Default(Index(addresses.state), state = 'MA', cid ASC, aid)
                IndexScan_Default(Index(addresses.state), state = 'NY', cid ASC, aid)
              IndexScan_Default(Index(addresses.state), state = 'VT', cid ASC, aid)
        Product_Nested(customers - addresses x customers - orders - items)
          Filter_Default(customers - orders - items)
            Flatten_HKeyOrdered(customers - orders INNER items)
              Flatten_HKeyOrdered(customers INNER orders)
                BranchLookup_Nested(customers -> orders, items)