PhysicalSelect[cid:int]
  Map_NestedLoops(0)
    GroupLookup_Default(Index(parent.PRIMARY) -> parent)
      IndexScan_Default(Index(parent.PRIMARY), id > 1)
    Project_Default(customers.cid)
      Map_NestedLoops(1)
        Flatten_HKeyOrdered(customers INNER items)
          Select_HKeyOrdered(items.quan > 100)
            GroupLookup_Default(Index(customers.cname_and_sku) -> customers, items)
              IndexScan_Default(Index(customers.cname_and_sku), customers.name = parent.name, items.sku = '1234')
        Product_Nested(customers - items x customers - addresses)
          Select_HKeyOrdered(addresses.city != customers.name)
            Filter_Default(customers - addresses)
              Flatten_HKeyOrdered(customers INNER addresses)
                Select_HKeyOrdered(parent.state == addresses.state)
                  BranchLookup_Nested(customers -> addresses)