# Tests for all logarithm functions: LOG, LOG2, LOG10, LN
---
- Include: all-types-schema.yaml
---
- Statement: INSERT INTO all_types(double_field, bigint_field, varchar_field) VALUES (1.0, 1.0, '1.0');
---
- Statement: SELECT LOG(2.5) from all_types;
- output_types: [DOUBLE]
---
- Statement: SELECT LOG2(4) from all_types;
- output: [[2.0]]
--- # This LOG10(1000) returns 2.99999999 instead of 3. Could be a bug?
- Statement: SELECT (LOG10(1000) - 3.0) < 0.0001 from all_types;
- output: [[true]]
---
- Statement: SELECT LN(2.5) - LOG(2.5) from all_types;
- output: [[0.0]]
---
- Statement: SELECT LOG(10, 100) from all_types;
- output: [[2.0]]
---
- Statement: SELECT LOG(2, 8) from all_types;
- output: [[3.0]]
---
- Statement: SELECT LOG(10, 100) from all_types;
- output: [[2.0]]
---
- Statement: SELECT LOG(null) from all_types;
- output: [[null]]
---
- Statement: SELECT LOG(null, 2.4) from all_types;
- output: [[null]]
---
- Statement: SELECT LOG(null, null) from all_types;
- output: [[null]]
---
- Statement: SELECT LOG(2.4, null) from all_types;
- output: [[null]]
---
- Statement: SELECT LOG2(null) from all_types;
- output: [[null]]
---
- Statement: SELECT LN(null) from all_types;
- output: [[null]]
---
- Statement: SELECT LOG10(null) from all_types;
- output: [[null]]
---
- Statement: SELECT double_field from all_types WHERE LOG(10, 100) = 2;
- output: [[1.0]]
---
- Statement: SELECT double_field from all_types WHERE LOG(2, 32) = LOG2(32);
- output: [[1.0]]
---
- Statement: SELECT double_field from all_types WHERE LOG(35) = LN(35);
- output: [[1.0]]
---
- Statement: SELECT double_field from all_types WHERE LOG(null) IS NULL;
- output: [[1.0]]
---
- Statement: SELECT double_field from all_types WHERE LN(null) IS NULL;
- output: [[1.0]]
---
- Statement: SELECT double_field from all_types WHERE LOG2(null) IS NULL;
- output: [[1.0]]
## Tests with params
---
- Statement: SELECT LOG(?) - LN(34) from all_types;
- params: [[34]]
- output: [[0.0]]
---
- Statement: SELECT LOG2(?) from all_types;
- params: [[16]]
- output: [[4.0]]
---
- Statement: SELECT LOG10(?) from all_types;
- params: [[100]]
- output: [[2.0]]
---
- Statement: SELECT varchar_field from all_types WHERE LOG(?) IS NULL;
- params: [[null]]
- output: [['1.0']]
---
- Statement: SELECT varchar_field from all_types WHERE LOG(?, 2) IS NULL;
- params: [[null]]
- output: [['1.0']]
---
- Statement: SELECT varchar_field from all_types WHERE LOG(2, ?) = LOG2(5.4);
- params: [[5.4]]
- output: [['1.0']]
---
- Statement: SELECT varchar_field from all_types WHERE LOG(67.4) = LN(?);
- params: [['67.4']]
- output: [['1.0']]
# Tests with fields
---
- Statement: SELECT LOG(double_field) from all_types;
- output: [[0.0]]
---
- Statement: SELECT LOG(3, double_field) from all_types;
- output: [[0.0]]
---
- Statement: SELECT LOG10(bigint_field) from all_types;
- output: [[0.0]]
---
- Statement: SELECT LOG2(varchar_field) from all_types;
- output: [[0.0]]
---
- Statement: SELECT LOG2(double_field) from all_types;
- output: [[0.0]]
---
- Statement: SELECT LN(double_field) from all_types;
- output: [[0.0]]
---
- Statement: SELECT varchar_field from all_types WHERE LOG(double_field) = LN(double_field);
- output: [['1.0']]
---
- Statement: SELECT varchar_field from all_types WHERE LOG10(double_field) = 0.0;
- output: [['1.0']]
---
- Statement: INSERT INTO all_types(float_field) VALUES (null);
---
- Statement: SELECT LN(float_field) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
---
- Statement: SELECT LOG(float_field) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
---
- Statement: SELECT LOG2(float_field) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
---
- Statement: SELECT LOG10(float_field) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
---
## Test wrong arity:
- Statement: SELECT LOG() from all_types;
- error: !select-engine { all: [4250C], sys-mysql: [1582] } 
---
- Statement: SELECT LOG(1, 3, 5) from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LOG2() from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LOG2(2,3) from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LOG2(2, 3, 5) from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LOG10() from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LOG10(2, 3) from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LOG10(2, 4, 5) from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LN() from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LN(2, 4) from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT LN(2, 3,5) from all_types;
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
## Test inappropriate input
- Statement: SELECT LOG(0) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
--- # arg should not be negative
- Statement: SELECT LOG(-2) from all_types;
- output: [[null], [null]]
--- # base should not be 1
- Statement: SELECT LOG(1, 2) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
--- # base should not be 0
- Statement: SELECT LOG(0, 5) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
---
- Statement: SELECT LN(-2) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
---
- Statement: SELECT LOG2(-20) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
---
- Statement: SELECT LOG10(-5) from all_types WHERE bigint_field IS NOT NULL;
- output: [[null]]
...
