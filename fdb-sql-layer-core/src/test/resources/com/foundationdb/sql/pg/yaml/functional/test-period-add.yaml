---
- Include: all-types-schema.yaml
---
- Statement: INSERT INTO all_types (integer_field) VALUES (201105)
--- # Wrong arity
- Statement: SELECT PERIOD_ADD() FROM all_types
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT PERIOD_ADD(201105) FROM all_types
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
---
- Statement: SELECT PERIOD_ADD(201105, 5, 15) FROM all_types
- error: !select-engine {all: [4250C], sys-mysql: [1582] }
--- # Month is not 1-12
- Statement: SELECT PERIOD_ADD(199300, 0) FROM all_types
- output: [[199212]]
---
- Statement: SELECT PERIOD_ADD(199313, 5) FROM all_types
- output: [[199406]]
--- # Literal values with YYYYMM arguments
- Statement: SELECT PERIOD_ADD(199001, 2) FROM all_types
- output: [[199003]]
---
- Statement: SELECT PERIOD_ADD(199001, 24) FROM all_types
- output: [[199201]]
---
- Statement: SELECT PERIOD_ADD(199006, 7) FROM all_types
- output: [[199101]]
---
- Statement: SELECT PERIOD_ADD(200506, -3) FROM all_types
- output: [[200503]]
---
- Statement: SELECT PERIOD_ADD(200506, -27) FROM all_types
- output: [[200303]]
---
- Statement: SELECT PERIOD_ADD(200506, -6) FROM all_types
- output: [[200412]]
--- # Literals, repeated as YYMM arguments
- Statement: SELECT PERIOD_ADD(9001, 2) FROM all_types
- output: [[199003]]
---
- Statement: SELECT PERIOD_ADD(9001, 24) FROM all_types
- output: [[199201]]
---
- Statement: SELECT PERIOD_ADD(9006, 7) FROM all_types
- output: [[199101]]
---
- Statement: SELECT PERIOD_ADD(0506, -3) FROM all_types
- output: [[200503]]
---
- Statement: SELECT PERIOD_ADD(0506, -27) FROM all_types
- output: [[200303]]
---
- Statement: SELECT PERIOD_ADD(0506, -6) FROM all_types
- output: [[200412]]
--- # Varying lengths
- Statement: SELECT PERIOD_ADD(100, 0) FROM all_types
- output: [[200012]]
---
- Statement: SELECT PERIOD_ADD(1, 1) FROM all_types
- output: [[200002]]
---
- Statement: SELECT PERIOD_ADD(95, 1) FROM all_types
- output: [[200712]]
---
- Statement: SELECT PERIOD_ADD(951, 13) FROM all_types
- output: [[201404]]
---
- Statement: SELECT PERIOD_ADD(2951, 13) FROM all_types
- output: [[203404]]
---
- Statement: SELECT PERIOD_ADD(954321, 3) FROM all_types
- output: [[954412]]
--- # Leading zeroes
- Statement: SELECT PERIOD_ADD(001, 0001) FROM all_types
- output: [[200002]]
---
- Statement: SELECT PERIOD_ADD(95, 01) FROM all_types
- output: [[200712]]
---
- Statement: SELECT PERIOD_ADD(00951, 13) FROM all_types
- output: [[201404]]
---
- Statement: SELECT PERIOD_ADD(2951, 013) FROM all_types
- output: [[203404]]
---
- Statement: SELECT PERIOD_ADD(0954321, 00003) FROM all_types
- output: [[954412]]
--- # Negative period
- Statement: SELECT PERIOD_ADD(-200006, -6) FROM all_types
- output: [[-200012]]
---
- Statement: SELECT PERIOD_ADD(-6, -6) FROM all_types
- output: [[-200012]]
---
- Statement: SELECT PERIOD_ADD(-200101, 1) FROM all_types
- output: [[-200012]]
---
- Statement: SELECT PERIOD_ADD(-100000, 24006) FROM all_types
- output: [[100006]]
---
- Statement: SELECT PERIOD_ADD(-101, 1) FROM all_types
- output: [[-200012]]
--- # Params
- Statement: SELECT PERIOD_ADD(?, 12) FROM all_types
- params: [[199309]]
- output: [[199409]]
---
- Statement: SELECT PERIOD_ADD(6712, ?) FROM all_types
- params: [[-5]]
- output: [[206707]]
---
- Statement: SELECT PERIOD_ADD(?, ?) FROM all_types
- params: [[199002, 100]]
- output: [[199806]]
--- # Using table
- Statement: DELETE FROM all_types
---
- Statement: INSERT INTO all_types (bigint_field, integer_field) VALUES (1103, 3), (201103, -15)
---
- Statement: SELECT PERIOD_ADD (bigint_field, integer_field) FROM all_types
- output: [[201106], [200912]]
---
- Statement: DELETE FROM all_types
--- # Null tests
- Statement: INSERT INTO all_types (integer_field) VALUES (5)
---
- Statement: SELECT integer_field FROM all_types WHERE PERIOD_ADD(null, 5) IS NULL
- output: [[5]]
---
- Statement: SELECT integer_field FROM all_types WHERE PERIOD_ADD(201115, null) IS NULL
- output: [[5]]
---
- Statement: SELECT integer_field FROM all_types WHERE PERIOD_ADD(null, null) IS NULL
- output: [[5]]
...